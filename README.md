# Производство ТСЗП

Интерактивная система планирования производства с календарём, маршрутными картами и инструментами планирования работ.

## Технологический стек

- **Next.js 14** (App Router)
- **React 18** + **TypeScript**
- **Tailwind CSS**
- **Material UI** для интерфейса
- **Zustand** для состояния клиента
- **Prisma** (PostgreSQL) — модель данных
- **@hello-pangea/dnd** для drag-and-drop
- **Recharts** для визуализации отчётности

## Локальный запуск

### Шаг 1. Установка зависимостей

Убедитесь, что установлен Node.js версии не ниже 18 (проверить можно командой `node -v`). После этого в корне репозитория выполните:

```bash
npm install
```

Команда скачает пакеты из `package.json` и создаст папку `node_modules`. При сетевых ошибках повторите установку или используйте `npm install --legacy-peer-deps`.

### Шаг 2. Запуск dev-сервера

После успешной установки зависимостей запустите режим разработки Next.js:

```bash
npm run dev
```

Сервер стартует на `http://localhost:3000`, автоматически пересобирает код при изменениях и выводит журнал в терминал.

### Шаг 3. Открытие приложения в браузере

Перейдите в браузере по адресу `http://localhost:3000`. Первичная загрузка может занять несколько секунд на сборку. Если порт 3000 занят, укажите другой (`PORT=4000 npm run dev`) и откройте соответствующий адрес.

По умолчанию mock-данные хранятся в памяти (см. `data/mockData.ts`). Для подключения настоящей базы данных PostgreSQL необходимо:

1. Указать строку подключения `DATABASE_URL` в `.env`.
2. Выполнить миграции Prisma: `npx prisma migrate dev`.
3. Реализовать реальные обработчики в API, используя `prisma` из `lib/prisma.ts`.

## Структура приложения

- `app/` — страницы, макеты и API-маршруты Next.js.
- `components/` — общие компоненты, включая навигацию.
- `views/` — отдельные вкладки приложения (календарь, маршрутные карты, операции, планирование и отчётность).
- `store/` — глобальное состояние и доступ к API.
- `data/mockData.ts` — временное хранилище данных.
- `prisma/schema.prisma` — схема данных производства.

## Основные возможности

- Производственный календарь с фильтрами и легендой операций.
- Управление маршрутными картами и статусами.
- Конструктор маршрутных карт с динамическими шагами.
- Справочник операций с созданием новых операций.
- Планирование работ с drag-and-drop и визуализацией занятости участков.
- Панель аналитики (KPI и загрузка участков).

## Безопасность и роли

Роли пользователей и дальнейшие сценарии авторизации определены в `prisma/schema.prisma`. Для полной интеграции с системой авторизации необходимо добавить эндпоинты аутентификации и middleware проверки JWT/OAuth2.
